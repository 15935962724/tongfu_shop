<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>我的SP-增值商品订单</title>
    <script src="../js/huaceng.js" language="javascript" th:src="@{/assets/js/huaceng.js}"></script>
    <script type="text/javascript" src="../js/jquery.min.js" th:src="@{/assets/js/jquery.min.js}"></script>
    <link href="../css/home.css" type="text/css"  rel="stylesheet" th:href="@{/assets/css/home.css}"/>
    <script type="text/javascript" src="../js/jquery.js" th:src="@{/assets/js/jquery.js}"></script>
    <script type="text/javascript" src="../js/accordion.js" th:src="@{/assets/js/accordion.js}"></script>
    <script type="text/javascript" src="../js/qiehuan.js" th:src="@{/assets/js/qiehuan.js}"></script>
    <script src="../js/layDate-v5.0.9/laydate/laydate.js" th:src="@{/assets/js/layDate-v5.0.9/laydate/laydate.js}"></script>
    <link href="../css/index.css" rel="stylesheet" type="text/css" th:href="@{/assets/css/index.css}">

    <link href="../css/demo.css" rel="stylesheet" type="text/css" th:href="@{/assets/css/demo.css}">
    <link href="../css/iconfont.css" rel="stylesheet" type="text/css" th:href="@{/assets/css/iconfont.css}">
    <script src="../css/iconfont.js" language="javascript" th:src="@{/assets/css/iconfont.js}"></script>

    <!--我的sp鼠标悬浮下拉-->
    <script th:src="@{/assets/js/memberView.js}"></script>

</head>

<body>

<header>

    <!--语言切换-->
    <!--未登录-->
    <shiro:notAuthenticated>
        <th:block th:replace="~{incloud/language::language}"></th:block>
    </shiro:notAuthenticated>
    <!--已登录-->
    <shiro:authenticated>
        <th:block th:replace="~{incloud/languageLogin::language}"></th:block>
    </shiro:authenticated>

    <div class="head">
        <!--未登录-->
        <div th:replace="~{head::topbar}"></div>
        <!--已登录-->
    </div>

</header>


<div class="log_con" style="padding-top:0px;">
    <div class="luj"><a th:href="@{/}" >首页</a>&gt;<a href="javaScript:void (0);">我的SP</a></div>
    <div class="con_sp">
        <script>
            $(function(){
                $('.nav .nav-header-li-div').click(function(){
                    if($(this).parent().hasClass('active')) {
                        $(this).parent().removeClass('active').addClass("active-none");
                    }else{
                        $(this).parent().removeClass('active-none').addClass("active").siblings().removeClass('active').addClass("active-none");
                        $(this).parent().siblings().find('.nav-second-level li').removeClass('active1');
                    }
                });

                $('.nav-second-level li').click(function(){
                    $(this).addClass('active1').siblings().removeClass('active1');
                });
            })
        </script>

        <!--引用页面左侧-->
        <div th:replace="/incloud/conLeft:: con_left"></div>

        <div class="con_right">
<form name="casesform" id="casesform" th:action="@{/order/addcases}" method="post" enctype="multipart/form-data">
    <input type="hidden" name="orderId" th:value="${orderId}"/>
            <div class="bingli">
                <h1>添加病例</h1>
                <table width="100%" border="0" cellpadding="0" cellspacing="0" >
                    <tr>
                        <td class="IDh"><font>*</font>患者ID号：</td>
                        <td><input type="text" name="patientid" placeholder="请输入患者ID号" /></td>
                    </tr>
                    <tr>
                        <td class="IDh">患者姓名：</td>
                        <td><input type="text" name="name" placeholder="" /></td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>地区：</td>
                        <td>
                            <select name="sheng">
                            </select>
                            <select name="shi">
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>来源医院：</td>
                        <td><input type="text" name="hospital" placeholder="" /></td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>科室：</td>
                        <td><input type="text" name="department" placeholder="" /></td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>医生姓名：</td>
                        <td><input type="text" name="doctor" placeholder="" /></td>
                    </tr>
                    <!--<tr>-->
                        <!--<td class="IDh"><font>*</font>交付时间：</td>-->
                        <!--<td><input type="text" id="test1" placeholder="2019-05-20" name="deliveryDate">-->
                            <!--<span style="    padding-left: 15px;-->
    <!--font-size: 12px;-->
    <!--color: #fe1111;-->
<!--}"><i class="iconfont" style="font-size: 16px;margin-right: 8px;">&#xe60d;</i>交付时间选择仅支持提交数据病例后24小时</span>-->
                            <!--<script>-->
                                <!--//执行一个laydate实例-->
                                <!--laydate.render({-->
                                    <!--elem: '#test1' //指定元素-->
                                <!--});-->
                                <!--laydate.render({-->
                                    <!--elem: '#test2' //指定元素-->
                                <!--});-->
                            <!--</script></td>-->
                    <!--</tr>-->
                    <!--<tr>-->
                        <!--<td class="IDh"><font>*</font>术前讨论时间：</td>-->
                        <!--<td><input type="text" id="test1" placeholder="2019-05-20" name="discussDate">-->

                        <!--</td>-->
                    <!--</tr>-->
                    <tr>
                        <td class="IDh"><font>*</font>交付时间：</td>
                        <td><input type="text" id="test1" placeholder="2019-05-21">
                            <script src="../js/layDate-v5.0.9/laydate/laydate.js"></script><span style="    padding-left: 15px; font-size: 12px;color: #fe1111;}">
                                <i class="iconfont" style="font-size: 16px;margin-right: 8px;">&#xe60d;</i>交付时间选择仅支持提交数据病例后24小时</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>术前讨论时间：</td>
                        <td><input type="text" id="test2" placeholder="2019-05-21">
                            <script>
                                //执行一个laydate实例
                                laydate.render({
                                    elem: '#test1' //指定元素
                                });
                                laydate.render({
                                    elem: '#test2' //指定元素
                                });
                            </script></td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>初步诊断：</td>
                        <td><textarea name="diagnosis" placeholder=""></textarea></td>
                    </tr>
                    <tr>
                        <td style="text-align:right;">具体要求：</td>
                        <!--<td><div class="yaoq">-->
                            <!--<li><label>-->
                                <!--<input type="checkbox" name="CheckboxGroup1" value="交付时间具体要求" id="CheckboxGroup1_0" />交付时间具体要求</label></li>-->
                            <!--<li><label>-->
                                <!--<input type="checkbox" name="CheckboxGroup1" value="交付时间具体要求" id="CheckboxGroup1_0" />交付时间具体要求</label></li>-->
                            <!--<li><label>-->
                                <!--<input type="checkbox" name="CheckboxGroup1" value="交付时间具体要求" id="CheckboxGroup1_0" />交付时间具体要求</label></li></div></td>-->
                        <td><textarea name="demand" placeholder=""></textarea></td>
                    </tr>
                    <tr>
                        <td class="IDh"><font>*</font>上传DICOM数据和诊断报告：</td>
                        <td>
                            <!--<input type="submit" value="上传文件">-->
                            <input type="file" name="datafiles" value="上传文件">
                            <span style="font-size: 12px;color: #999;padding-left: 10px;">上传前请确保患者影像数据符合数据要求，并压缩成.rar格式.</span></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td><button><a href="javascript:fnsubmit()">保存</a></button><button class="cez1"><a href="#">取消</a></button></td>
                    </tr>
                </table>


            </div>
</form>
        </div>
    </div>
</div>
<script type="text/javascript">
    var hl = $(".con_left").outerHeight();
    var hr = $(".con_right").outerHeight();
    var mh = Math.max(hl,hr);
    $(".con_left").height(mh);
    $(".con_right").height(mh);
    $(function(){
        dataSource(0,0);
     });
    //加载子集数据
    function dataSource(e,id) {
        // alert(id);
        var sheng;
        if(e==0){
            sheng = $("select[name='sheng']");
        }else if(e==1){
            sheng=$("select[name='shi']");
        }

        var html = "";

        $.ajax({
            type:"GET",
            url:'[[@{/area/queryList}]]',
            data:{parent:id},
            dataType:"json",
            async: false,
            success:function(data){
                if(data.length>0){
                    html = html+ '<option>--请选择--</option>';
                    for (var i = 0;i<data.length;i++){
                        html = html+ '<option data_value = "'+data[i].name+'," value="'+data[i].id+'">'+data[i].name+'</option>';
                    }

                }
                sheng.append(html);
            }
        });

    }
    // 单击下拉框调用
    $(document).on('change','select',function(){
        var id=$(this).val();
        var name=$(this).attr("name");
        $(this).next().html("");
        if(name=="sheng"){
            dataSource(1,id);

        }


    });
    //提交
    function fnsubmit() {

        var formData = new FormData($("#casesform")[0]);
        $.ajax({
            type:"post",
            url:'[[@{/order/addcases}]]',

            data:formData,
            async: false,
            cache: false, //上传文件不需要缓存
            processData: false, // 告诉jQuery不要去处理发送的数据
            contentType: false, // 告诉jQuery不要去设置Content-Type请求头
            success:function(data){

console.log("data====="+data);
                if(data==1) {
                    var tongfu= '[[@{/}]]';

                    alert("添加成功");
                    var url = tongfu+"order/orderList";

                    location.href = url;

                }
                else
                {
                    alert("添加失败");
                }


            },error:function () {
                alert("失败1111")
            }
        });
    }
</script>

<!--引用页面脚部-->
<div th:replace="/incloud/footer:: footer"></div>

</body>
</html>
